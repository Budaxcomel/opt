:root{
  --bg:#fff3f8; --bg2:#f5fbff; --card:#fff; --text:#2a2b33; --muted:#6b6f86;
  --line:rgba(30,30,60,.10);
  --pri:#ff7bb8; --pri2:#7ad7ff;
  --shadow:0 18px 55px rgba(40,30,60,.14);
  --r:18px;
  --glass: rgba(255,255,255,.78);
  --glass2: rgba(255,255,255,.62);
  --bgGlow1: rgba(255,123,184,.35);
  --bgGlow2: rgba(122,215,255,.30);
  --bgGlow1b: rgba(255,123,184,.10);
  --bgGlow2b: rgba(122,215,255,.12);
  --cardGlow1: rgba(255,123,184,.25);
  --cardGlow2: rgba(122,215,255,.22);

  --inputBg: rgba(255,123,184,.06);
  --inputBgFocus: rgba(255,123,184,.08);
  --inputBorderFocus: rgba(255,123,184,.55);
  --focusRing: rgba(255,123,184,.14);
  --focusOutline: rgba(122,215,255,.55);
  --primaryShadow: rgba(255,123,184,.18);

  --badgeBg: rgba(255,123,184,.08);
  --trackBg1: rgba(122,215,255,.15);
  --trackBg2: rgba(255,123,184,.10);
  --resultBg1: rgba(255,123,184,.10);
  --resultBg2: rgba(122,215,255,.08);

  --navActiveBorder: rgba(255,123,184,.22);
  --navActiveBg1: rgba(255,123,184,.14);
  --navActiveBg2: rgba(122,215,255,.12);

  --spinnerTop: rgba(255,123,184,.90);
  --toastInfoBg: rgba(122,215,255,.22);

}
*{box-sizing:border-box}
html{scroll-behavior:smooth}
@media (prefers-reduced-motion: reduce){
  html{scroll-behavior:auto}
}

body{
  margin:0;
  min-height:100vh;
  font-family:system-ui,Segoe UI,Roboto,Arial;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  color:var(--text);
  background:
    radial-gradient(1000px 500px at 10% -10%, var(--bgGlow1), transparent 60%),
    radial-gradient(900px 500px at 90% 0%, var(--bgGlow2), transparent 55%),
    linear-gradient(180deg,var(--bg),var(--bg2));
}

body::before{
  content:"";
  position:fixed; inset:-20%;
  pointer-events:none;
  z-index:-1;
  background:
    radial-gradient(800px 500px at 20% 30%, var(--bgGlow1b), transparent 62%),
    radial-gradient(900px 520px at 80% 20%, var(--bgGlow2b), transparent 60%);
  animation:bgFloat 18s ease-in-out infinite alternate;
}
@keyframes bgFloat{to{transform:translate3d(2%, -2%, 0)}}
@media (prefers-reduced-motion: reduce){
  body::before{animation:none}
}


/* Style Packs (UI theme presets) */
body[data-style="minimal"]{
  --pri:#3b82f6; --pri2:#22c55e;
  --bgGlow1: rgba(59,130,246,.22);
  --bgGlow2: rgba(34,197,94,.16);
  --bgGlow1b: rgba(59,130,246,.10);
  --bgGlow2b: rgba(34,197,94,.10);
  --cardGlow1: rgba(59,130,246,.18);
  --cardGlow2: rgba(34,197,94,.14);

  --inputBg: rgba(59,130,246,.05);
  --inputBgFocus: rgba(59,130,246,.07);
  --inputBorderFocus: rgba(59,130,246,.55);
  --focusRing: rgba(59,130,246,.14);
  --focusOutline: rgba(59,130,246,.55);
  --primaryShadow: rgba(59,130,246,.18);

  --badgeBg: rgba(15,23,42,.04);
  --trackBg1: rgba(59,130,246,.14);
  --trackBg2: rgba(34,197,94,.10);
  --resultBg1: rgba(59,130,246,.10);
  --resultBg2: rgba(34,197,94,.07);

  --navActiveBorder: rgba(59,130,246,.18);
  --navActiveBg1: rgba(59,130,246,.10);
  --navActiveBg2: rgba(34,197,94,.08);

  --spinnerTop: rgba(59,130,246,.90);
  --toastInfoBg: rgba(59,130,246,.18);
}

body[data-style="arcade"]{
  --pri:#00f5ff; --pri2:#ff3df0;
  --bgGlow1: rgba(0,245,255,.24);
  --bgGlow2: rgba(255,61,240,.18);
  --bgGlow1b: rgba(0,245,255,.12);
  --bgGlow2b: rgba(255,61,240,.10);
  --cardGlow1: rgba(0,245,255,.18);
  --cardGlow2: rgba(255,61,240,.14);

  --inputBg: rgba(0,245,255,.05);
  --inputBgFocus: rgba(0,245,255,.08);
  --inputBorderFocus: rgba(0,245,255,.60);
  --focusRing: rgba(0,245,255,.16);
  --focusOutline: rgba(0,245,255,.60);
  --primaryShadow: rgba(0,245,255,.22);

  --badgeBg: rgba(0,245,255,.08);
  --trackBg1: rgba(0,245,255,.12);
  --trackBg2: rgba(255,61,240,.10);
  --resultBg1: rgba(0,245,255,.10);
  --resultBg2: rgba(255,61,240,.07);

  --navActiveBorder: rgba(0,245,255,.22);
  --navActiveBg1: rgba(0,245,255,.12);
  --navActiveBg2: rgba(255,61,240,.10);

  --spinnerTop: rgba(0,245,255,.92);
  --toastInfoBg: rgba(0,245,255,.18);
}

body[data-style="minimal"]::before{opacity:.55}
body[data-style="arcade"]::before{opacity:.85}

body[data-style="arcade"] .primary{filter:saturate(1.15)}
body[data-style="arcade"] .primary{box-shadow:0 12px 38px var(--primaryShadow)}

.topbar{
  position:sticky;top:0;z-index:10;
  display:flex;justify-content:space-between;align-items:center;
  padding:14px 14px;
  background:linear-gradient(to bottom, rgba(255,255,255,.88), rgba(255,255,255,0));
  backdrop-filter: blur(10px);
}
.brand{display:flex;gap:12px;align-items:center}
.logo{
  width:42px;height:42px;border-radius:14px;
  box-shadow:var(--shadow);
  background:
    radial-gradient(circle at 35% 25%, rgba(255,255,255,.95), rgba(255,255,255,0) 45%),
    linear-gradient(135deg,var(--pri),var(--pri2));
}
.title{font-weight:950; letter-spacing:.2px}
.sub{font-size:12px;color:var(--muted)}

.shell{
  max-width:980px;
  margin:0 auto;
  padding:0 14px calc(120px + env(safe-area-inset-bottom));
}

/* Layout (desktop feels premium) */
.layout{display:grid; grid-template-columns:1fr; gap:12px; margin-top:12px}
@media(min-width:920px){
  .layout{grid-template-columns:1fr 1fr; align-items:start}
}
.col{display:flex;flex-direction:column;gap:12px}
.col .card{margin:0}

.card{
  background:var(--card);
  border:1px solid var(--line);
  border-radius:var(--r);
  padding:14px;
  margin:12px 0;
  box-shadow:var(--shadow);
  scroll-margin-top:84px;
}
.gradient{
  background:
    radial-gradient(900px 260px at 10% 0%, var(--cardGlow1), transparent 60%),
    radial-gradient(800px 260px at 90% 0%, var(--cardGlow2), transparent 55%),
    var(--card);
}

.card.reveal{
  opacity:0;
  transform:translateY(10px);
  transition:opacity .35s ease, transform .35s ease;
}
.card.reveal.in{
  opacity:1;
  transform:none;
}

.row{display:flex;gap:10px;align-items:center;flex-wrap:wrap;margin-top:10px}
.space{justify-content:space-between;margin-top:0}

.grid2{display:grid;grid-template-columns:1fr;gap:10px}
@media(min-width:760px){.grid2{grid-template-columns:1fr 1fr}}

.input{
  width:100%;
  border:1px solid var(--line);
  border-radius:14px;
  padding:12px;
  background:var(--inputBg);
  outline:none;
  transition:border-color .15s ease, box-shadow .15s ease, background .15s ease;
}
.input:focus{
  border-color:var(--inputBorderFocus);
  box-shadow:0 0 0 4px var(--focusRing);
  background:var(--inputBgFocus);
}

.passWrap{position:relative; display:flex; align-items:center}
.passWrap .input{padding-right:44px}
.iconBtn{
  position:absolute; right:8px; top:50%;
  transform:translateY(-50%);
  width:36px;height:36px;
  border-radius:12px;
  border:1px solid var(--line);
  background:rgba(255,255,255,.65);
  cursor:pointer;
  display:flex;align-items:center;justify-content:center;
}
.iconBtn:active{transform:translateY(-50%) scale(.98)}

.pill{
  border:1px solid var(--line);
  border-radius:999px;
  padding:10px 14px;
  background:rgba(255,255,255,.92);
  font-weight:950;
  cursor:pointer;
  position:relative;
  overflow:hidden;
  transition:transform .06s ease, filter .15s ease, opacity .15s ease, box-shadow .15s ease;
}
.pill:hover{filter:brightness(1.02)}
.pill:active{transform:translateY(1px)}
.pill:disabled{opacity:.55;cursor:not-allowed}
.primary{
  border:none;
  background:linear-gradient(135deg,var(--pri),var(--pri2));
  box-shadow:0 12px 30px var(--primaryShadow);
}
.primary::after{
  content:"";
  position:absolute; inset:-40%;
  background:radial-gradient(circle at 30% 30%, rgba(255,255,255,.55), rgba(255,255,255,0) 60%);
  opacity:.55;
  transform:translate3d(-12%, -12%, 0);
}
.ghost{background:transparent}

:focus-visible{
  outline:3px solid var(--focusOutline);
  outline-offset:2px;
}

.muted{color:var(--muted)}
.small{font-size:12px}
.big{font-size:22px;font-weight:950}

.stats{display:flex;gap:10px;flex-wrap:wrap}
.stat{
  border:1px solid var(--line);
  border-radius:16px;
  padding:10px 12px;
  background:var(--glass2);
  backdrop-filter: blur(10px);
}
.k{font-size:12px;color:var(--muted)}
.v{font-size:16px;font-weight:950}

.badge{
  font-size:11px;
  padding:6px 10px;
  border-radius:999px;
  border:1px solid var(--line);
  background:var(--badgeBg);
  color:var(--muted);
  backdrop-filter: blur(10px);
}

/* Track */
.track{
  height:150px;
  border-radius:18px;
  border:1px solid var(--line);
  background:linear-gradient(180deg, var(--trackBg1), var(--trackBg2));
  position:relative;
  overflow:hidden;
  margin-top:12px;
  touch-action:manipulation;
  box-shadow:inset 0 1px 0 rgba(255,255,255,.5);
}
.track.tappable{cursor:pointer}
.track.tappable:active{filter:brightness(.985)}

/* Track background (moving stripes) */
.trackBg{
  position:absolute;inset:0;
  background:
    radial-gradient(800px 220px at 30% 10%, rgba(255,255,255,.55), transparent 62%),
    radial-gradient(900px 260px at 80% 0%, rgba(255,255,255,.35), transparent 60%),
    repeating-linear-gradient(90deg, rgba(255,255,255,.12) 0 18px, rgba(255,255,255,0) 18px 34px);
  opacity:.8;
  animation:trackMove 1.35s linear infinite;
}
@keyframes trackMove{to{transform:translateX(-34px)}}

/* Runner = CSS kitty */
.runner{
  --fur:#ff7bb8;
  --fur2:#7ad7ff;
  width:46px;height:34px;border-radius:14px 14px 12px 12px;
  position:absolute;left:16px;top:70px;
  background:
    radial-gradient(circle at 17px 16px, rgba(255,255,255,.92) 0 2px, transparent 2.6px),
    radial-gradient(circle at 29px 16px, rgba(255,255,255,.92) 0 2px, transparent 2.6px),
    radial-gradient(circle at 23px 21px, rgba(40,30,60,.30) 0 2px, transparent 2.6px),
    linear-gradient(135deg,var(--fur),var(--fur2));
  box-shadow:var(--shadow);
  transform:translateY(0);
  transition:transform .12s ease, filter .15s ease;
  filter:saturate(1.06);
}
.runner::before{
  /* ears */
  content:"";
  position:absolute;left:8px;top:-8px;
  width:10px;height:10px;
  background:var(--fur);
  border-radius:2px;
  transform:rotate(45deg);
  box-shadow:18px 0 0 0 var(--fur);
}
.runner::after{
  /* tail */
  content:"";
  position:absolute;right:-10px;top:12px;
  width:18px;height:10px;border-radius:999px;
  background:linear-gradient(135deg,var(--fur2),var(--fur));
  transform:rotate(-18deg);
  filter:brightness(1.02);
}
.runner.skin-1{--fur:#ff7bb8;--fur2:#7ad7ff}
.runner.skin-2{--fur:#a78bfa;--fur2:#7ad7ff}
.runner.skin-3{--fur:#34d399;--fur2:#7ad7ff}
.runner.skin-4{--fur:#fbbf24;--fur2:#ff7bb8}
.runner.skin-5{--fur:#fb7185;--fur2:#a78bfa}

.runner.jump{transform:translateY(-44px) rotate(-3deg)}
.runner.hit{animation:hitShake .25s linear 1}
@keyframes hitShake{
  0%{transform:translateY(0) translateX(0)}
  25%{transform:translateY(0) translateX(-3px)}
  50%{transform:translateY(0) translateX(4px)}
  75%{transform:translateY(0) translateX(-2px)}
  100%{transform:translateY(0) translateX(0)}
}
.tapBurst{
  position:absolute;inset:0;
  pointer-events:none;
  opacity:0;
  transition:opacity .15s;
}
.tapBurst.on{
  opacity:1;
  background:radial-gradient(circle at 50% 50%, rgba(255,255,255,.55), transparent 55%);
}

/* HUD */
.hud{display:flex;justify-content:space-between;gap:10px;align-items:flex-start;margin-top:10px}
.hudLeft{min-width:220px;flex:1}
.hudRight{display:flex;gap:8px;flex-wrap:wrap;justify-content:flex-end}
.meter{height:10px;border-radius:999px;border:1px solid var(--line);background:rgba(255,255,255,.55);overflow:hidden}
.meter .fill{height:100%;width:0%;border-radius:999px;background:linear-gradient(135deg,var(--pri),var(--pri2))}

/* Obstacles */
.obsLayer{position:absolute;inset:0;pointer-events:none}
.obs{
  position:absolute;bottom:22px;
  width:18px;height:18px;border-radius:8px;
  background:rgba(40,30,60,.26);
  border:1px solid rgba(255,255,255,.25);
  box-shadow:0 10px 28px rgba(40,30,60,.22);
}

/* Settings */
.settingsGrid{display:flex;gap:10px;flex-wrap:wrap;margin-top:8px}
.toggle{display:flex;align-items:center;gap:8px;padding:8px 10px;border-radius:14px;border:1px solid var(--line);background:var(--glass2); backdrop-filter: blur(10px)}
.toggle input{transform:scale(1.05)}

.segmented{
  display:flex;
  gap:8px;
  padding:8px;
  margin-top:10px;
  border-radius:999px;
  border:1px solid var(--line);
  background:var(--glass2);
  backdrop-filter: blur(14px);
}
.segBtn{
  flex:1;
  border:1px solid transparent;
  background:transparent;
  border-radius:999px;
  padding:10px 12px;
  font-weight:950;
  cursor:pointer;
  position:relative;
  overflow:hidden;
  transition:transform .06s ease, filter .15s ease, box-shadow .15s ease;
}
.segBtn:hover{filter:brightness(1.02)}
.segBtn:active{transform:translateY(1px)}
.segBtn.active{
  background:linear-gradient(135deg, var(--navActiveBg1), var(--navActiveBg2));
  border-color:var(--navActiveBorder);
  box-shadow:0 12px 30px var(--primaryShadow);
}


/* Result */
.result{
  margin-top:12px;
  border-radius:16px;
  border:1px solid var(--line);
  background:linear-gradient(180deg, var(--resultBg1), var(--resultBg2));
  padding:12px;
}
.result .grade{font-weight:950;font-size:24px}
.result .grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:10px}

/* Lists */
.list{display:flex;flex-direction:column;gap:10px;margin-top:12px}
.item{
  border:1px solid var(--line);
  border-radius:16px;
  padding:12px;
  background:rgba(255,255,255,.85);
  display:flex;
  justify-content:space-between;
  gap:10px;
}

/* Skeleton shimmer */
.skeleton{
  position:relative;
  overflow:hidden;
}
.skeleton::after{
  content:"";
  position:absolute; inset:0;
  transform:translateX(-100%);
  background:linear-gradient(90deg, rgba(255,255,255,0), rgba(255,255,255,.55), rgba(255,255,255,0));
  animation:shimmer 1.1s ease-in-out infinite;
}
@keyframes shimmer{to{transform:translateX(100%)}}
.skLine{
  height:10px;
  border-radius:999px;
  background:rgba(40,30,60,.10);
  margin:8px 0;
}

/* Ripple */
.ripple{
  position:absolute;
  width:12px;height:12px;
  border-radius:999px;
  transform:translate(-50%,-50%);
  background:rgba(255,255,255,.55);
  pointer-events:none;
  animation:ripple .55s ease-out forwards;
}
@keyframes ripple{
  from{opacity:.65}
  to{width:260px;height:260px;opacity:0}
}

/* Bottom navigation */
.bottomNav{
  position:fixed;
  left:50%;
  transform:translateX(-50%);
  bottom:0;
  width:min(980px, 100%);
  padding:10px 10px calc(10px + env(safe-area-inset-bottom));
  display:flex;
  gap:8px;
  background:linear-gradient(180deg, rgba(255,255,255,0), var(--glass));
  backdrop-filter: blur(14px);
  border-top:1px solid var(--line);
  z-index:12;
}
.navBtn{
  flex:1;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap:4px;
  border:1px solid transparent;
  border-radius:16px;
  padding:8px 8px;
  background:transparent;
  color:var(--muted);
  cursor:pointer;
  transition:transform .06s ease, background .15s ease, color .15s ease, border-color .15s ease;
}
.navBtn .ico{width:20px;height:20px}
.navBtn span{font-size:11px; font-weight:850}
.navBtn:active{transform:translateY(1px)}
.navBtn.active{
  color:var(--text);
  border-color:var(--navActiveBorder);
  background:linear-gradient(135deg, var(--navActiveBg1), var(--navActiveBg2));
}

/* Back to top button */
.fabTop{
  position:fixed;
  right:14px;
  bottom:calc(86px + env(safe-area-inset-bottom));
  width:44px;height:44px;
  border-radius:16px;
  border:1px solid var(--line);
  background:var(--glass);
  backdrop-filter: blur(12px);
  box-shadow:var(--shadow);
  cursor:pointer;
  z-index:12;
}
.fabTop:active{transform:translateY(1px)}

/* Modal */
.modal{
  position:fixed;
  inset:0;
  display:flex;
  align-items:flex-end;
  justify-content:center;
  padding:14px;
  padding-bottom:calc(14px + env(safe-area-inset-bottom));
  background:rgba(0,0,0,.35);
  backdrop-filter: blur(10px);
  z-index:20;
}
.modalCard{
  width:min(980px,100%);
  max-height:82vh;
  overflow:auto;
  background:var(--card);
  border:1px solid var(--line);
  border-radius:var(--r);
  box-shadow:var(--shadow);
  padding:14px;
  transform:translateY(12px);
  opacity:0;
  transition:transform .22s ease, opacity .22s ease;
}
.modal.show .modalCard{transform:none; opacity:1}

/* Busy overlay */
.busy{
  position:fixed; inset:0;
  display:flex; align-items:center; justify-content:center;
  background:rgba(0,0,0,.22);
  backdrop-filter: blur(10px);
  z-index:30;
}
.busyCard{
  width:min(420px, 92vw);
  border-radius:22px;
  border:1px solid var(--line);
  background:var(--glass);
  box-shadow:var(--shadow);
  padding:14px;
  display:flex; align-items:center; gap:12px;
}
.spinner{
  width:22px;height:22px;border-radius:999px;
  border:3px solid rgba(255,255,255,.35);
  border-top-color:var(--spinnerTop);
  animation:spin .9s linear infinite;
}
@keyframes spin{to{transform:rotate(360deg)}}
.busyMsg{font-weight:850}

/* Toast */
.toast{
  position:fixed;
  left:50%;
  bottom:calc(18px + env(safe-area-inset-bottom) + 64px);
  transform:translate(-50%, 10px);
  opacity:0;
  width:min(520px, 92vw);
  background:rgba(40,30,60,.82);
  color:#fff;
  padding:10px 12px;
  border-radius:18px;
  border:1px solid rgba(255,255,255,.18);
  backdrop-filter:blur(12px);
  z-index:25;
  transition:opacity .18s ease, transform .18s ease;
}
.toast.show{opacity:1; transform:translate(-50%, 0)}
.toastInner{display:flex; align-items:center; gap:10px}
.toastIcon{
  width:26px;height:26px;
  border-radius:12px;
  background:rgba(255,255,255,.16);
  display:flex; align-items:center; justify-content:center;
}
.toast[data-type="success"] .toastIcon{background:rgba(34,197,94,.22)}
.toast[data-type="error"] .toastIcon{background:rgba(239,68,68,.22)}
.toast[data-type="info"] .toastIcon{background:var(--toastInfoBg)}
.toastIcon::before{content:"ℹ️"}
.toast[data-type="success"] .toastIcon::before{content:"✅"}
.toast[data-type="error"] .toastIcon::before{content:"⚠️"}
.toastMsg{font-weight:850; line-height:1.25}
.toastBar{
  height:3px;
  border-radius:999px;
  background:rgba(255,255,255,.14);
  margin-top:8px;
  overflow:hidden;
}
.toastBarFill{
  height:100%;
  width:100%;
  transform-origin:left;
  transform:scaleX(0);
  background:linear-gradient(135deg,var(--pri),var(--pri2));
  animation:toastBar 2.4s linear forwards;
}
@keyframes toastBar{to{transform:scaleX(1)}}

/* Dark mode */
body[data-theme="dark"]{
  --bg:#070a13; --bg2:#0c1020; --card:rgba(17,26,51,.86);
  --text:#e9ecff; --muted:#a8b0d6;
  --line:rgba(255,255,255,.10);
  --shadow:0 18px 55px rgba(0,0,0,.45);
  --glass: rgba(13, 18, 34, .72);
  --glass2: rgba(13, 18, 34, .58);
  --inputBg: rgba(255,255,255,.06);
  --inputBgFocus: rgba(255,255,255,.08);
}
body[data-theme="dark"] .pill{background:rgba(255,255,255,.06);color:var(--text)}
body[data-theme="dark"] .primary{color:#071022}
body[data-theme="dark"] .stat{background:rgba(0,0,0,.20)}
body[data-theme="dark"] .item{background:rgba(0,0,0,.18)}
body[data-theme="dark"] .iconBtn{background:rgba(0,0,0,.20)}
body[data-theme="dark"] .ripple{background:rgba(255,255,255,.18)}

/* Respect reduced motion */
@media (prefers-reduced-motion: reduce){
  .trackBg{animation:none}
  .pill{transition:none}
  .runner{transition:none}
  .card.reveal{transition:none}
  .toast{transition:none}
  .toastBarFill{animation:none}
  .spinner{animation:none}
  .skeleton::after{animation:none}
}
